{% extends  'base.html' %}

{% block active %}class="active"{% endblock %} 

{% block title %}
    Bets
{% endblock %}

{% block content_title %}
    Турнирная таблица
{% endblock %}

{% block content%}
<!--div class="row">
			<div class="col-md-6 col-sm-6 col-lg-3 col-12 mb-4">
                            <div class="card ">
                                <div class="card-body">
                                    <div class="text-center">
                                        <p class="mb-4 text-muted text-small">Первое место</p>
                                        <img class="img-thumbnail border-0 rounded-circle mb-4 list-thumbnail" style="object-fit: cover; width: 100px; height: 100px;" alt="This is anonymous picture" src="https://starbets.herokuapp.com/static/a.jpg" />
                                        <p class="list-item-heading mb-1">Антон Вольных</p>
                                    </div>
                                </div>
                            </div>
            </div>
            			<div class="col-md-6 col-sm-6 col-lg-3 col-12 mb-4">
                            <div class="card ">
                                <div class="card-body">
                                    <div class="text-center">
                                        <p class="mb-4 text-muted text-small">Второе место</p>
                                        <img class="img-thumbnail border-0 rounded-circle mb-4 list-thumbnail" style="object-fit: cover; width: 100px; height: 100px;" alt="This is anonymous picture" src="https://starbets.herokuapp.com/static/admin.jpg" />
                                        <p class="list-item-heading mb-1">Лесли Хэдланд</p>
                                    </div>
                                </div>
                            </div>
            </div>

                        			<div class="col-md-6 col-sm-6 col-lg-3 col-12 mb-4">
                            <div class="card ">
                                <div class="card-body">
                                    <div class="text-center">
                                        <p class="mb-4 text-muted text-small">Третье место</p>
                                        <img class="img-thumbnail border-0 rounded-circle mb-4 list-thumbnail" style="object-fit: cover; width: 100px; height: 100px;" alt="This is anonymous picture" src="https://starbets.herokuapp.com/static/kk.jpg" />
                                        <p class="list-item-heading mb-1">Светка и собака</p>
                                    </div>
                                </div>
                            </div>
            </div>
</div-->

<!--Это тестовая таблица для бекэа-->

<div class="row flex-row flex-nowrap">
    <div class="col-lg-12 col-md-12 mb-12">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Турнирая таблица EURO2021 Новая</h5>
                <table border="3" width="100%" class="responsive nowrap">
                    <thead>
                        <tr style="height: 116px;">
                            <th width="5px;" scope="col">№</th>
                            <th width="20px;"scope="col">Имя</th>
                            {% for match, data in main_table_dict.items() %}
                                <th width="5px;" class="rotatable" scope="col">{{data.team1}}</th>
                                <th style="border-right: 3px solid;" width="5px;" class="rotatable" scope="col">{{data.team2}}</th>
                            {% endfor %}
                            <th width="15px;"scope="col">Очки</th>
                        </tr>
                    </thead>
                    <tbody>
                     <tr>
                            <th></th>
                            <td>Результат игры</td>
                            {% for match, data in main_table_dict.items() %}
                                <td width="5px;">{{data.t1_res}}</td>
                                <td style="border-right: 3px solid;" width="5px;">{{data.t2_res}}</td>
                            {% endfor %}
                            <td></td>
                        </tr>
                     {% for user in all_users %}
                            <tr>
                            <th rowspan="2">1</th>
                            <td rowspan="2">{{user.fio}}</td>

                            {% for match, data in main_table_dict.items() %}
                                 <td width="5px;">{{data["users"][user.id]["t1_pre"]}}</td>
                                 <td style="border-right: 3px solid;" width="5px;">{{data["users"][user.id]["t2_pre"]}}</td>
                            {% endfor %}
                            </tr>
                            <tr>
                            {% for match, data in main_table_dict.items() %}
                                <td width="10px;" style="background-color: #2f76e2; text-align: center;"colspan="2">{{data["users"][user.id]["scor"]}}</td>
                            {% endfor %}
                                </tr>
                            {% endfor %}

                    </tbody>
                </table>
            </div>
        </div>
    </div> 
</div>


<div class="row">
    <div class="col-lg-6 col-md-6 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Турнирая таблица EURO2021</h5>
                <table  width="100%" class="table">
                    <thead>
                        <tr>
                            <th width="5px;" scope="col">№</th>
                            <th width="20%;"scope="col">Имя</th>
                            <th scope="col">Игры</th>
                            <th width="15px;"scope="col">Очки</th>
                        </tr>
                    </thead>
                    <tbody>
						
						{%set count =[0]%}
						{% for user, matchid in bets_dict.items() %}
                            {% if count.append(count.pop() + 1) %}{% endif %}<tr>
                            <th scope="row">{{count[0]}}</th>
                            <td>{{user}}</td>
                            <td>
                            {%set res = [0]%}
                            {%for matchidid, bets in matchid.items()%}
                                {% for bet, info in bets.items() %}
                                    {% if res.append(res.pop() + bet | int) %}{% endif %}
                                    {%if bet|int() == 5 %}
                                    <span style="cursor: pointer; color: #ff8f00;" data-toggle="tooltip" data-placement="top" title="{{info}}"><b>{{bet}}</b></span>
                                    {%elif bet|int() == 4 %}
                                    <span style="cursor: pointer; color: #00b3d2;" data-toggle="tooltip" data-placement="top" title="{{info}}"><b>{{bet}}</b></span>
                                    {%elif bet|int() == 3 %}
                                    <span style="cursor: pointer; color: #129803;" data-toggle="tooltip" data-placement="top" title="{{info}}"><b>{{bet}}</b></span>
                                    {%elif bet|int() == 2 %}
                                    <span style="cursor: pointer; color: #2f76e2;" data-toggle="tooltip" data-placement="top" title="{{info}}"><b>{{bet}}</b></span>
                                    {%else%}
                                    <span style="cursor: pointer;" data-toggle="tooltip" data-placement="top" title="{{info}}"><b>{{bet}}</b></span>
                                    {%endif%}
                                {% endfor %}

                            {% endfor %}
                            </td>
                            <td>{{res[0]}}</td>
                        </tr> {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div> 
</div>

<div class="row">
    <div class="col-lg-9 col-md-12 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Турнирая таблица EURO2021 (Сортировка)</h5>
                <table  width="100%" class="data-table data-table-scrollable responsive nowrap"  data-order="[[ 3, &quot;desc&quot; ]]">
                    <thead>
                        <tr>
                            <th width="5px;" scope="col">№</th>
                            <th width="20%;"scope="col">Имя</th>
                            <th scope="col">Игры</th>
                            <th width="15px;"scope="col">Очки</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                        {%set count =[0]%}
                        {% for user, matchid in bets_dict.items() %}
                            {% if count.append(count.pop() + 1) %}{% endif %}<tr>
                            <th scope="row">{{count[0]}}</th>
                            <td>{{user}}</td>
                            <td>
                            {%set res = [0]%}
                            {%for matchidid, bets in matchid.items()%}
                                {% for bet, info in bets.items() %}
                                    {% if res.append(res.pop() + bet | int) %}{% endif %}
                                    {%if bet|int() == 5 %}
                                    <span style="cursor: pointer; color: #ff8f00;" data-toggle="tooltip" data-placement="top" title="{{info[0]}}"><b>{{bet}}</b></span>
                                    {%elif bet|int() == 4 %}
                                    <span style="cursor: pointer; color: #00b3d2;" data-toggle="tooltip" data-placement="top" title="{{info[0]}}"><b>{{bet}}</b></span>
                                    {%elif bet|int() == 3 %}
                                    <span style="cursor: pointer; color: #129803;" data-toggle="tooltip" data-placement="top" title="{{info[0]}}"><b>{{bet}}</b></span>
                                    {%elif bet|int() == 2 %}
                                    <span style="cursor: pointer; color: #2f76e2;" data-toggle="tooltip" data-placement="top" title="{{info[0]}}"><b>{{bet}}</b></span>
                                    {%else%}
                                    <span style="cursor: pointer;" data-toggle="tooltip" data-placement="top" title="{{info[0]}}"><b>{{bet}}</b></span>
                                    {%endif%}
                                {% endfor %}
                            {% endfor %}
                                {#<!--Короче, вот как обращаться к переменным, но они будут работать только внутри того цикла который выше!
                                    Возможно придется менять структуру цикла и всей переменной под новую таблицу...
                                    {{info[1]['match.team1']}}, {{info[1]['match.team2']}}, {{info[1]['bet.t1_pre']}}, {{info[1]['bet.t2_pre']}},
                                   {{info[1]['match.t1_res']}}, {{info[1]['match.t2_res']}}, {{info[1]['bet.comment']}}
                               -->#}


                            </td>
                            <td>{{res[0]}}</td>
                        </tr> {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div> 
</div>

{% endblock %}